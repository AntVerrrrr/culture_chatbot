{% load static %}
{% load i18n %}
<link rel="stylesheet" href="{% static 'css/setting/language_dropdown_custom.css' %}">

{% get_current_language as CURRENT_LANG %}
{% get_language_info for CURRENT_LANG as CUR %}
{% get_available_languages as LANGS %}
{% get_language_info_list for LANGS as languages %}

<form id="langForm" action="{% url 'set_language' %}" method="post">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.path }}">

    <!-- 원본 select (접근성/JS 용도로만, 시각적으로 숨김) -->
    <select id="langSelect" name="language" class="sr-only" aria-label="{% trans '언어 선택' %}">
        {% for lang in languages %}
        <option value="{{ lang.code }}"
                data-label="{{ lang.name_local|capfirst }}"
                {% if lang.code == CURRENT_LANG %}selected{% endif %}>
            {{ lang.name_local|capfirst }}
        </option>
        {% endfor %}
    </select>

    <!-- 커스텀 UI -->
    <div class="lang-menu">
        <button type="button" id="langTrigger" class="lang-trigger" aria-haspopup="true" aria-expanded="false">
<!--            {# 깃발: 코드에 지역이 붙으면(예: en-us) 접두 2자만 쓰고 싶다면 slice 사용 #}-->
            <img id="langTriggerFlag" class="lang-flag"
                 src="{% static 'image/includes/language_dropdown/' %}{{ CURRENT_LANG|slice:':2' }}.png" alt="">
            <span id="langTriggerLabel">{{ CUR.name_local|capfirst }}</span>
            <svg class="chevron" viewBox="0 0 20 20">
                <path d="M5 7l5 6 5-6" stroke="currentColor" stroke-width="2" fill="none"/>
            </svg>
        </button>

        <div id="langPanel" class="lang-panel" role="menu" aria-labelledby="langTrigger">
            {% for lang in languages %}
            <button type="button" class="lang-item"
                    data-lang="{{ lang.code }}"
                    data-label="{{ lang.name_local|capfirst }}">
                <img class="lang-flag" src="{% static 'image/includes/language_dropdown/' %}{{ lang.code|slice:':2' }}.png" alt="">
                <span>{{ lang.name_local|capfirst }}</span>
            </button>
            {% endfor %}
        </div>
    </div>
</form>


<!--&lt;!&ndash; 언어 드롭다운 JS를 여기서 전역 로드 &ndash;&gt;-->
<script src="{% static 'js/setting/language_dropdown.js' %}" defer></script>
<script src="{% static 'js/setting/language_dropdown_custom.js' %}" defer></script>


<!--{% load static %}-->
<!--{% load i18n %}-->
<!--<form id="langForm" action="{% url 'set_language' %}" method="post">-->
<!--  {% csrf_token %}-->
<!--  <input type="hidden" name="next" value="{{ request.path }}">-->

<!--  {% get_current_language as CURRENT_LANG %}-->
<!--  {% get_available_languages as LANGS %}-->
<!--  {% get_language_info_list for LANGS as languages %}-->

<!--  <select id="langSelect" name="language" aria-label="{% trans '언어 선택' %}">-->
<!--    {% for lang in languages %}-->
<!--      <option-->
<!--        value="{{ lang.code }}"-->
<!--        {% if lang.code == CURRENT_LANG %}selected{% endif %}-->
<!--        dir="{% if lang.bidi %}rtl{% else %}ltr{% endif %}"-->
<!--      >-->
<!--        {{ lang.name_local|capfirst }}  {# 예: 한국어, English, 日本語, Français, Deutsch #}-->
<!--        {# 참고: {{ lang.name }} (영문명), {{ lang.name_translated }} (현재 UI 언어로 번역된 이름) #}-->
<!--      </option>-->
<!--    {% endfor %}-->
<!--  </select>-->
<!--</form>-->

<!--&lt;!&ndash; 언어 드롭다운 JS를 여기서 전역 로드 &ndash;&gt;-->
<!--<script src="{% static 'js/setting/language_dropdown.js' %}" defer></script>-->
<!--<script src="{% static 'js/setting/language_dropdown_custom.js' %}" defer></script>-->
